<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Times - Humble</title>
  <style>
    :root {
      --cor-dourado: #d1a720;
      --cor-fundo: #1a1a1a;
      --cor-texto: #f5f5f5;
    }

    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: linear-gradient(135deg, rgba(20,20,20,0.85), rgba(40,30,20,0.85)),
                  url("https://i.imgur.com/vATNRmF.png") no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      color: var(--cor-texto);
    }

    /* HEADER */
    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      padding: 15px 20px;
      display: flex; justify-content: space-between; align-items: center;
      background: rgba(20,20,20,0.9);
      border-bottom: 2px solid var(--cor-dourado);
      z-index: 1000;
    }
    header h1 {
      font-size: 1.6rem;
      margin: 0;
      display: flex; align-items: center; gap: 12px;
      color: var(--cor-dourado);
    }
    header h1 img { height: 40px; }

    .header-right { display: flex; gap: 15px; align-items: center; }
    #loginBtn, #signupBtn {
      background: none; border: 1px solid var(--cor-dourado);
      color: var(--cor-dourado); padding: 5px 10px;
      border-radius: 6px; cursor: pointer; transition: .2s;
    }
    #loginBtn:hover, #signupBtn:hover {
      background: var(--cor-dourado); color: var(--cor-fundo);
    }

    /* MENU HAMBURGUER */
    .menu-toggle {
      display: flex; flex-direction: column; justify-content: space-between;
      width: 30px; height: 22px; cursor: pointer;
    }
    .menu-toggle span {
      display: block; height: 4px;
      background: var(--cor-texto);
      border-radius: 4px; transition: 0.3s;
    }
    .menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
    .menu-toggle.active span:nth-child(2) { opacity: 0; }
    .menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

    nav {
      position: absolute; top: 65px; right: 10px;
      background: rgba(30,25,20,0.95);
      border: 1px solid var(--cor-dourado);
      border-radius: 12px; padding: 15px; gap: 12px;
      display: none; flex-direction: column;
    }
    nav.active { display: flex; }
    nav a { color: var(--cor-dourado); text-decoration: none; }
    nav a:hover { color: var(--cor-texto); }

    /* BOT√ÉO CRIAR TIME */
    #criarTimeBtn {
      display: block; margin: 120px auto 20px auto;
      background: var(--cor-dourado); color: var(--cor-fundo);
      font-weight: bold; border: none;
      padding: 10px 16px; border-radius: 8px;
      cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,.5);
    }
    #criarTimeBtn:hover { background: #f1c53b; }

    main { padding: 20px; }

    .time-card {
      background: rgba(30,25,20,0.9);
      border: 1px solid var(--cor-dourado);
      border-radius: 12px; padding: 15px; margin-bottom: 20px;
    }

    /* MODAL */
    .modal {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.7);
      justify-content: center; align-items: center;
      z-index: 2000;
    }
    .modal-content {
      background: rgba(30,25,20,0.95);
      border: 2px solid var(--cor-dourado);
      border-radius: 12px;
      padding: 20px;
      max-width: 750px; width: 95%;
      max-height: 90vh; overflow-y: auto;
    }

    .pokemon-card {
      border: 1px solid var(--cor-dourado);
      border-radius: 10px;
      padding: 12px; margin-bottom: 15px;
      background: rgba(20,20,20,0.9);
    }
    .pokemon-card h3 { color: var(--cor-dourado); margin: 0 0 10px; }

    .stat { margin: 6px 0; }
    .stat label { display: inline-block; width: 50px; }
    .stat input[type=range] { width: 200px; }
    .iv-value, .ev-value { margin-left: 8px; color: var(--cor-dourado); font-weight: bold; }
    .progress { background: #333; height: 8px; border-radius: 6px; overflow: hidden; margin: 8px 0; }
    .progress-bar { background: var(--cor-dourado); height: 100%; width: 0%; transition: .3s; }
    .ev-warning { color: red; font-size: 0.9rem; }
  </style>
</head>
<body>
  <header>
    <h1>
      <a href="index.html"><img src="https://i.imgur.com/XOEcuO8.png" alt="Mascote"></a>
      Humble
    </h1>
    <div class="header-right">
      <button id="loginBtn">Login</button>
      <button id="signupBtn">Cadastrar</button>
      <div class="menu-toggle" id="menuBtn"><span></span><span></span><span></span></div>
    </div>
    <nav id="dropdownMenu">
      <a href="index.html">üè† In√≠cio</a>
      <a href="https://www.humblepixelmon.com.br">üåê Site Oficial</a>
      <a href="Tiers_1.12.html">üó°Ô∏è Tiers 1.12</a>
      <a href="Tiers_1.16.html">üõ°Ô∏è Tiers 1.16</a>
      <a href="notas.html">üìù Notas de Atualiza√ß√£o</a>
    </nav>
  </header>

  <button id="criarTimeBtn">+ Criar Time</button>
  <main id="timesContainer"></main>

  <!-- Modal Criar Time -->
  <div class="modal" id="timeModal">
    <div class="modal-content">
      <h2>Criar Novo Time</h2>
      <div id="pokemonSlots"></div>
      <button id="addPokemonBtn">+ Adicionar Pok√©mon</button>
      <button id="salvarTimeBtn">Salvar Time</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut,
             createUserWithEmailAndPassword, signInWithEmailAndPassword } 
             from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getDatabase, ref, push, set, get, child } 
             from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "sampleteans.firebaseapp.com",
      databaseURL: "https://sampleteans-default-rtdb.firebaseio.com",
      projectId: "sampleteans",
      storageBucket: "sampleteans.firebasestorage.app",
      messagingSenderId: "1069510029261",
      appId: "1:1069510029261:web:ccafa840ebf0e2a0e85e84"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);
    const provider = new GoogleAuthProvider();

    const criarTimeBtn = document.getElementById("criarTimeBtn");
    const timeModal = document.getElementById("timeModal");
    const salvarTimeBtn = document.getElementById("salvarTimeBtn");
    const addPokemonBtn = document.getElementById("addPokemonBtn");
    const pokemonSlots = document.getElementById("pokemonSlots");

    const stats = ["HP","Atk","Def","SpA","SpD","Spe"];
    let pokemonCount = 0;

    // FUN√á√ÉO CRIAR CARD DE POKEMON
    function createPokemonCard(i){
      const div=document.createElement("div");
      div.className="pokemon-card";
      div.innerHTML=`
        <h3>Pok√©mon ${i}</h3>
        <label>Tier:</label>
        <select class="tier"><option>OU</option><option>UU</option><option>NU</option><option>Uber</option></select><br><br>
        <label>Nome:</label><input type="text" class="pokemonName"><br><br>
        <label>Nature:</label><select class="nature"><option>Adamant</option><option>Modest</option><option>Jolly</option></select><br><br>
        <label>Ability:</label><input type="text" class="ability"><br><br>
        <label>Moves:</label><br>
        <input type="text" class="move" placeholder="Move 1"><br>
        <input type="text" class="move" placeholder="Move 2"><br>
        <input type="text" class="move" placeholder="Move 3"><br>
        <input type="text" class="move" placeholder="Move 4"><br><br>
        <strong>IVs</strong><br>
        ${stats.map(stat=>`
          <div class="stat"><label>${stat}</label>
            <input type="range" min="0" max="31" value="31" class="iv">
            <span class="iv-value">31</span>
          </div>`).join("")}
        <br><strong>EVs</strong><br>
        ${stats.map(stat=>`
          <div class="stat"><label>${stat}</label>
            <input type="range" min="0" max="252" step="4" value="0" class="ev">
            <span class="ev-value">0</span>
          </div>`).join("")}
        <div class="progress"><div class="progress-bar"></div></div>
        <div class="ev-warning"></div>
      `;
      pokemonSlots.appendChild(div);
    }

    addPokemonBtn.onclick=()=>{
      if(pokemonCount<6){
        pokemonCount++;
        createPokemonCard(pokemonCount);
      } else {
        alert("M√°ximo de 6 Pok√©mon por time.");
      }
    };

    pokemonSlots.addEventListener("input", e=>{
      if(e.target.classList.contains("iv")){
        e.target.nextElementSibling.textContent=e.target.value;
      }
      if(e.target.classList.contains("ev")){
        e.target.nextElementSibling.textContent=e.target.value;
        validateEVs(e.target.closest(".pokemon-card"));
      }
    });

    function validateEVs(card){
      let evs=[...card.querySelectorAll(".ev")].map(ev=>parseInt(ev.value));
      let total=evs.reduce((a,b)=>a+b,0);
      let over252=evs.filter(v=>v===252).length;
      let warning=card.querySelector(".ev-warning");
      let bar=card.querySelector(".progress-bar");
      bar.style.width=(total/508*100)+"%";
      if(total>508) warning.textContent="‚ö†Ô∏è M√°ximo total 508 EVs.";
      else if(over252>2) warning.textContent="‚ö†Ô∏è M√°ximo 2 stats com 252 EVs.";
      else warning.textContent="";
    }

    criarTimeBtn.onclick=()=>{timeModal.style.display="flex";}
    timeModal.onclick=(e)=>{if(e.target===timeModal) timeModal.style.display="none";};

    salvarTimeBtn.onclick=()=>{
      if(!auth.currentUser) return alert("Precisa estar logado!");
      let team=[];
      pokemonSlots.querySelectorAll(".pokemon-card").forEach(card=>{
        let pokemon={
          tier:card.querySelector(".tier").value,
          name:card.querySelector(".pokemonName").value,
          nature:card.querySelector(".nature").value,
          ability:card.querySelector(".ability").value,
          moves:[...card.querySelectorAll(".move")].map(m=>m.value).filter(Boolean),
          ivs:Object.fromEntries(stats.map((s,i)=>[s,card.querySelectorAll(".iv")[i].value])),
          evs:Object.fromEntries(stats.map((s,i)=>[s,card.querySelectorAll(".ev")[i].value]))
        };
        if(pokemon.name) team.push(pokemon);
      });
      push(ref(db,"teams"),{
        ownerName:auth.currentUser.displayName||auth.currentUser.email,
        ownerUid:auth.currentUser.uid,
        pokemons:team
      });
      timeModal.style.display="none";
      alert("Time salvo!");
    };

    /* MENU HAMBURGUER */
    const menuBtn=document.getElementById("menuBtn");
    const dropdownMenu=document.getElementById("dropdownMenu");
    menuBtn.addEventListener("click",()=>{menuBtn.classList.toggle("active");dropdownMenu.classList.toggle("active");});
    document.addEventListener("click",(e)=>{if(!dropdownMenu.contains(e.target)&&!menuBtn.contains(e.target)){menuBtn.classList.remove("active");dropdownMenu.classList.remove("active");}});
  </script>
</body>
</html>
